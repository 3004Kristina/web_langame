jQuery(function(){let t=jQuery("#add-club-form"),e=t.find(".save_draft"),n=jQuery("#club_photos_input"),r=jQuery("#add-photo-input"),o=jQuery("#add-price-file-input"),i=jQuery("#add-price-file-hidden-input"),a=jQuery("#add-price-file-text");function l(t){return new Promise((n,r)=>{let e=new FormData;e.append("file",t,t.name),jQuery.ajax({url:"/upload.php",method:"post",data:e,processData:!1,contentType:!1,success:function({data:e,error:t}){if(t)return r(t);n(e)}})})}0!==t.length&&(e.on("click",function(e){jQuery.ajax({type:"POST",url:"",data:t.serialize(),success:function(){jQuery('[data-remodal-id="success_modal"]').remodal().open()}})}),t.on("submit",function(e){e.preventDefault(),jQuery.ajax({type:"POST",url:"",data:t.serialize(),success:function(){jQuery('[data-remodal-id="success_modal"]').remodal().open()}})}),o.on("change",function(e){return 0===this.files.length?(i.val(""),void a.text("Загрузить файл")):void l(this.files[0]).then(e=>{i.val(e),a.text("Файл загружен")})}),(()=>{let i=n.val().split(":").filter(e=>!!e);function a(){n.val(i.join(":")),jQuery(".add_photo_item").each(function(e){let t=jQuery(this);i[e]?(e=i[e],t.html(`
<img src="${e}"/>
<a href="#" class="remove_photo"></a>
`)):t.empty()})}r.on("change",function(){for(var e of this.files)l(e).then(e=>{e=e,i.push(e),a()});setTimeout(()=>r.attr("type","hidden"),0),setTimeout(()=>r.attr("type","file"),50)}),t.on("click",".add_photo_item .remove_photo",function(e){e.preventDefault();let t=jQuery(this),n=t.closest(".add_photo_item"),r=n.find("img"),o=r.attr("src");e=o,i.splice(i.indexOf(e),1),a()}),a()})())}),(()=>{const r=[112,48,96,113,49,97,114,50,98,115,51,99,116,52,100,117,53,101,118,54,102,119,55,103,120,56,104,121,57,105,122,123,8,9,46,13];jQuery.fn.extend({codeInput(e={}){let t=e.inputCount||4,n=e.inputWrapperClass||"code_input_wrapper";jQuery(this).each(function(){let o=jQuery(this),i=jQuery(`<div class="${n}"></div>`);for(let e=0;e<t;++e){let e=jQuery('<input type="text" maxlength="1">');e.on("keydown",function(e){var t=e.keyCode||e.which;-1===r.indexOf(t)&&e.preventDefault()}),e.on("keyup input",function(e){let t=jQuery(this),n=e.keyCode||e.which,r="";i.find("input").each(function(){r+=jQuery(this).val()}),o.val(r),8!==n&&46!==n?("input"===e.type&&o.trigger("input"),1===t.val().length&&(0<t.next("input").length?t.next("input").trigger("focus"):"input"===e.type&&setTimeout(()=>{o.trigger("change")},50))):t.val("").prev("input").trigger("focus")}),i.append(e)}o.hide(),o.after(i)})}}),jQuery(function(){jQuery("[data-input-code]").codeInput()})})(),jQuery.fn.extend({formWizard(e={}){let o=this,r=e.inputWrapperSelector||".form-group",i=e.inputErrorSelector||".error",t=e.submitButtonSelector||'[type="submit"]',n=e.prevButtonSelector||'[data-role="prev-tab-button"]',a=e.prevButtonText||"Назад",l=e.nextButtonSelector||'[data-role="next-tab-button"]',u=e.nextButtonText||"Вперед",c=e.tabSelector||'[data-role="tabs"]',s=e.activeTab||0,d=o.find(t),p=o.find(n),f=o.find(l),y=o.find(c);return y.length<=1||(h(s),f.on("click",function(){s>=y.length-1||!1!==function(){let e=y.eq(s),n=!1;return e.find("input, select, textarea").each(function(){b(this,"")}),e.find('input[required][type="text"]:not(:disabled),input[required][type="password"]:not(:disabled),input[required][type="email"]:not(:disabled),input[required][type="tel"]:not(:disabled),input[required][type="url"]:not(:disabled),input[required][type="number"]:not(:disabled),select[required]:not(:disabled),textarea[required]:not(:disabled)').each(function(){let e=jQuery(this),t=e.val();t||(n=!0,b(this,"Необходимо заполнить данное поле"))}),e.find('input[type="email"]:not(:disabled)').each(function(){let e=jQuery(this),t=e.val();t&&!1===/^.+@.+\..+$/.test(t)&&(n=!0,b(this,"Необходимо ввести валидный e-mail"))}),!1===n}()&&h(s+1)}),p.on("click",function(){0!==s&&h(s-1)}),this.on("input change","input, textarea, select",function(){b(this,"")})),o;function h(e){let t=y.hide().eq(e).show(),n=t.data("prev-button-text")||a,r=t.data("next-button-text")||u;d.toggle(e===y.length-1),p.toggle(0<e).text(n),f.toggle(e<y.length-1).text(r),s=e,o.trigger("show-tab",[s])}function b(e,t){let n=jQuery(e).closest(r).find(i);n.text(t||"")}}}),jQuery(function(){let e=jQuery(".hide-from-search-form"),t=e.find('input[type="checkbox"]');0!==e.length&&t.on("change",function(e){jQuery.ajax({type:"POST",url:"",data:{status:t.prop("checked")?"hidden":"active"},success:function(){jQuery('[data-remodal-id="success_modal"]').remodal().open()}})})}),jQuery(function(){let t=jQuery("body");jQuery(".mobile_menu_btn").on("click",function(e){e.preventDefault(),t.toggleClass("mobile-menu-opened")}),jQuery(".mobile_menu_bg").on("click",function(){t.removeClass("mobile-menu-opened")})}),window.Layout={initSelect2(){jQuery(".select2_wrapper select:not([data-select2-id])").each(function(){let e=jQuery(this);e.select2({minimumResultsForSearch:1/0,placeholder:e.data("placeholder"),dropdownParent:e.closest(".select2_wrapper"),width:"100%"})})}},jQuery(function(){let t=jQuery("#add-club-start-form"),n=jQuery("#add-club-code-confirm-form"),e=n.find(".step_back"),r,o;function i(e){var t=""+e%60;return""+Math.floor(e/60)+":"+(t=1===t.length?"0"+t:t)}0!==t.length&&(n.find('input[name="code"]').codeInput(),t.on("submit",function(e){e.preventDefault(),o=t.find('input[name="phone"]').val(),jQuery.ajax({type:"POST",url:"",data:t.serialize(),success:function(){t.hide(),n.find(".user_phone").text(o),n.show(),clearInterval(r),function(){clearInterval(r);let e=jQuery("#countdown"),t=jQuery("#reSendCode"),n=180;e.text(i(n)),t.addClass("disabled"),r=setInterval(function(){n--,e.text(i(n)),0===n&&(t.removeClass("disabled"),e.text(" "),clearInterval(r))},1e3)}()}})}),n.on("submit",function(e){e.preventDefault(),jQuery(".code_wrapper .error").text(""),jQuery.ajax({type:"POST",url:"",data:n.serialize(),success:function(e){e.error&&jQuery(".code_wrapper .error").text(e.error)}})}),e.on("click",function(e){n.trigger("reset"),n.hide(),t.show()}),jQuery("#reSendCode").on("click",function(e){t.trigger("submit")}))}),jQuery(function(){let e=document.getElementById("club_page_map");e&&window.ymaps&&ymaps.ready(()=>{new ymaps.Map(e,{center:[55.76,37.64],zoom:7})})}),jQuery(function(){let e=jQuery('[data-remodal-id="club_photo_modal"]'),n=jQuery(".club_photo_modal_wrapper"),r=jQuery("#show_club_photo_counter_slide");if(0!==e.length){let t=n.find(".slide_item").length;function o(e){r.text(`${e+1} / ${t}`)}o(0),e.on("opened",function(){n.slick({infinite:!0,slidesToShow:1,slidesToScroll:1,prevArrow:'<button type="button" class="slick-prev slick-arrow"><img src="../img/left.svg" alt="arrow"></button>',nextArrow:'<button type="button" class="slick-next slick-arrow"><img src="../img/right.svg" alt="arrow"></button>'}),n.on("beforeChange",function(e,t,n,r){o(r)})}),e.on("closed",function(){jQuery(".club_photo_modal_wrapper").slick("unslick")})}}),jQuery(function(){let t=jQuery("#user-profile-form"),r,n=t.find('input[name="phone"]'),o=t.find(".confirm_mobile_wrapper"),i=o.find(".confirm_mobile_descr"),a,l=t.find('input[name="phone"]').val();function u(){jQuery.ajax({type:"POST",url:"",data:t.serialize(),success:function(){jQuery('[data-remodal-id="success_modal"]').remodal().open()}})}function c(e){var t=""+e%60;return""+Math.floor(e/60)+":"+(t=1===t.length?"0"+t:t)}0!==t.length&&(t.find('input[name="code"]').codeInput(),t.on("submit",function(e){e.preventDefault(),a=n.val(),a!==l?jQuery.ajax({type:"POST",url:"",data:{phone:a},success:function(){jQuery(".user_profile_submit").addClass("disabled"),n.hide(),i.text(`Код отправлен на номер ${a}`).removeClass("error"),o.show(),clearInterval(r),function(){let e=jQuery("#countdown"),t=jQuery("#reSendCodeProfile"),n=180;e.text(c(n)),t.addClass("disabled"),r=setInterval(function(){n--,e.text(c(n)),0===n&&(t.removeClass("disabled"),e.text(" "),clearInterval(r))},1e3)}()}}):u()}),jQuery("#reSendCodeProfile").on("click",function(e){t.trigger("submit")}),t.on("change",'input[name="code"]',function(e){let t=jQuery(this);jQuery.ajax({type:"POST",url:"",data:{code:t.val()},success:function(e){e.error?i.text(e.error).addClass("error"):(u(),n.show(),o.hide(),clearInterval(r),jQuery(".user_profile_submit").removeClass("disabled"))}})}))}),jQuery(function(){function o(e,t){jQuery(e).each(function(){let e=jQuery(this);e.toggleClass("block_active",t),e.toggleClass("block_disabled",!t),e.find("input, select, textarea").each(function(){let e=jQuery(this);e.prop("disabled",!t)})})}Layout.initSelect2(),jQuery('input[type="checkbox"][data-toggle-block]').on("change init",function(e){let t=jQuery(this),n=t.data("toggle-block"),r=this.checked;o(n,r)}).trigger("init"),jQuery('input[type="radio"][data-activate-block]').on("change init",function(e){let t=jQuery(this),n=t.data("activate-block");o(n,!0)}).filter(":checked").trigger("init"),jQuery('input[type="radio"][data-disable-block]').on("change init",function(e){let t=jQuery(this),n=t.data("disable-block");o(n,!1)}).filter(":checked").trigger("init"),(()=>{let e=jQuery('[data-role="pc-configuration"]'),r=e.find('[data-role="pc-configuration-nav"]'),o=e.find('[data-role="pc-configuration-tabs"]'),t=jQuery("#configuration-tab-template"),i=e.find('[data-role="pc-configuration-create-tab"]'),n=t.html(),a=o.find('[data-role="pc-configuration-tab"]').length,l=a-1,u=l;function c(e){o.find("[data-tab]").removeClass("active").filter(`[data-tab="${e}"]`).addClass("active"),r.find("[data-show-tab]").removeClass("active").filter(`[data-show-tab="${e}"]`).addClass("active"),u=e}0!==e.length&&(i.on("click",function(e){var t;e.preventDefault(),t=l+1,e=function(e){return n.replace(/\{n\}/g,`${e}`)}(t),o.append(e),r.append(`
                <li data-nav-tab="${t}">
                    <a href="#" data-show-tab="${t}"></a>
                    <button type="button" data-remove-tab="${t}"></button>
                </li>
            `),Layout.initSelect2(),c(t),l=t,++a,i.prop("disabled",5<=a)}),e.on("click","[data-show-tab]",function(e){e.preventDefault();let t=jQuery(this),n=t.data("show-tab");c(n)}),e.on("click","[data-remove-tab]",function(e){e.preventDefault();let t=jQuery(this),n=t.data("remove-tab");!function(e){r.find(`[data-nav-tab="${e}"]`).remove(),o.find(`[data-tab="${e}"]`).remove(),u===e&&c(0);--a,i.prop("disabled",5<=a)}(n)}))})(),(()=>{let t=jQuery('[data-role="marketing-event-add-tab"]'),n=jQuery(".marketing_event .marketing_event_list"),r=n.find(".form-group").length;t.on("click",function(e){++r,n.append(`
             <div class="form-group" >
                <label for="marketing-event-input[${r}]">Акция №</label>
                <div class="input_wrapper" >
                    <input id="marketing-event-input[${r}]" name="marketing_event_descr[]" type="text" placeholder="Описание акции">
                    <div class="error"></div>
                </div>
                <button type="button" data-role-remove-marketing-event></button>
            </div>
            `),t.prop("disabled",5<=r)}),n.on("click","[data-role-remove-marketing-event]",function(e){e.preventDefault(),jQuery(this).closest(".form-group").remove(),--r,t.prop("disabled",5<=r)})})(),jQuery(window).on("scroll resize",function(){jQuery("[data-track-sticky]").each(function(){let e=jQuery(this),t=this.getBoundingClientRect().y;e.toggleClass("sticky",0===t).toggleClass("not-sticky",0!==t)})}),jQuery(".club_page_services_list .club_services_mobile_toggle").on("click",function(e){jQuery(this).toggleClass("active").closest(".club_page_services_list").toggleClass("mob_toggle").find(".mob_hide").toggleClass("active")}),jQuery("#add-club-form").formWizard({inputWrapperSelector:".form-group",inputErrorSelector:".error",submitButtonSelector:'[type="submit"]',prevButtonSelector:'[data-role="prev-tab-button"]',prevButtonText:"Назад",nextButtonSelector:'[data-role="next-tab-button"]',nextButtonText:"Продолжить",tabSelector:".form_tab"}).on("show-tab",function(e,t){jQuery(".person_add_club_modal_wrapper .remodal-wrapper").stop().animate({scrollTop:0},300)}),jQuery('input[type="tel"]').inputmask({mask:"+7 (999) 999-99-99",onincomplete:function(){this.value=""}}),jQuery("ul.club_list_navigation_tabs li a").on("click",function(e){e.preventDefault();let t=jQuery(this),n=jQuery(t.attr("href"));t.is(".active")||(jQuery("ul.club_list_navigation_tabs li a.active").removeClass("active"),t.addClass("active"),n.show(),jQuery(".club_list_content_tabs .tab").not(n).hide())}),jQuery(".club_page_toggle_content").on("click",function(e){jQuery(this).closest(".toggle_block_wrapper").find(".toggle_block").toggle(),jQuery(this).toggleClass("active")}),jQuery(".review_content_wrapper").scrollbar(),jQuery(".person_add_club_modal").remodal({appendTo:jQuery(".person_add_club_modal_wrapper"),hashTracking:!1}),jQuery(".show_club_price_list_modal").remodal({appendTo:jQuery(".club_page_modals_wrapper"),hashTracking:!1,closeOnOutsideClick:!1}),jQuery(".show_club_photo_modal").remodal({appendTo:jQuery(".club_page_modals_wrapper"),hashTracking:!1,closeOnOutsideClick:!1}),jQuery(".club_page_reviews_list").slick({infinite:!1,slidesToShow:4,slidesToScroll:1,variableWidth:!0,prevArrow:'<button type="button" class="slick-prev slick-arrow"><img src="../../img/left1.svg" alt="arrow"></button>',nextArrow:'<button type="button" class="slick-next slick-arrow"><img src="../../img/right1.svg" alt="arrow"></button>',responsive:[{breakpoint:700,settings:{slidesToShow:1,slidesToScroll:1}}]})});
//# sourceMappingURL=layout.js.map
